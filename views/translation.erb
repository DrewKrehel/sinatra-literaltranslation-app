<h1>Japanese gramar... but in English</h1>

<% client = OpenAI::Client.new(access_token: ENV.fetch("OPEN_AI_KEY"))

message_list_literal = [
  {
    "role" => "system",
    "content" => "You are a special translation tool. Your purpose is to restructure an English phrase using Japanese grammar and expressions, but continuing to use English words. Do not use any Japanese characters in your response. Do not reply with any additional comments or information beyond the literal translation."
  },
]

case @input_trans 
when "" then "Nothing"
else
  message_list_literal << { "role" => "user", "content" => @input_trans }
  api_response = client.chat(
      parameters: {
        model: "gpt-3.5-turbo",
        messages: message_list_literal
      }
    )

  #api_response
  @output_trans = api_response.fetch("choices").at(0).fetch("message").fetch("content")
end %>

<dl>
  <dt>
    <strong>Your sentance:</strong>
  </dt>
  <dd>
    <%= @input_trans %>
  </dd>

  <dt>
    <strong>Written phonetically</strong>
  </dt>
  <dd>
    <%= @phonetic_output %>
  </dd>

  <dt>
    <strong>Written with Kanji</strong>
  </dt>
  <dd>
    <%= @kanji_output %>
  </dd>

  <dt>
    <strong>The 'Literal' English Translation</strong>
  </dt>
  <dd>
    <%= @output_trans %>
  </dd>
</dl>

<p><a href="/">Go back home.</a></p>
